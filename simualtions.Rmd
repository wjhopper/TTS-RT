---
title: "Time-to-sample Reaction Time Model"
author: "Will Hopper"
date: "`r Sys.Date()`"
output:
  html_document:
    self_contained: true
params:
  duration: 30
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(pander)
source("TTS.R")
```

```{r seed}
set.seed(101)
```

```{r data, cache=TRUE}
mem_strengths <- data.frame(item = c(1:6, 1:9),
                            strength = c(0.4, 0.6, 0.6, 1.2, 1.2, 2.0,
                                         0.4, 0.5, 0.7,0.9,0.9, 1.0, 1.0,1.8, 1.8),
                            threshold = c(rep(0, 6), rep(.8, 9)),
                            set = c(rep(1, 6), rep(2, 9))
                            )
```

```{r no_threshold_simulations}
no_thresh_mem_strengths <- as.matrix(mem_strengths[mem_strengths[,"threshold"] == 0,])
pander(no_thresh_mem_strengths[, -4],
       caption = "Hypothetical Items in Memory")
sim_RT <- TTS(no_thresh_mem_strengths,
              duration = params$duration
              )
```

```{r analysis, fig.align="center", echo=FALSE}
meanRT_by_item <- colMeans(sim_RT, na.rm = TRUE)
plot(no_thresh_mem_strengths[,"strength"], meanRT_by_item,
     xlab = "Strength", ylab = "RT")

mean_acc_by_item <- apply(sim_RT, 2, function(x) mean(!is.na(x)))
avg_acc <- mean(mean_acc_by_item)
acc <- data.frame(t(mean_acc_by_item), avg_acc)
names(acc) <- c(paste("Item", as.character(1:length(mean_acc_by_item))), "Avg.")
pander(acc)

outputs_per_time_point <- numeric(params$duration)
for (t in 1:params$duration) {
  outputs_per_time_point[t] <- sum(sim_RT == t, na.rm = TRUE)
}

proportion <- outputs_per_time_point/prod(dim(sim_RT))
cum_proportion <- cumsum(proportion)

par(mfrow=c(1,2))

plot(seq_along(proportion), proportion,
     xlab = "Recall period (s)", ylab = "Relative Frequency"
     )

plot(seq_along(cum_proportion), cum_proportion,
     xlab = "Recall period (s)", ylab = "Proportion Recalled",
     ylim = c(0, 1)
     )

par(mfrow=c(1,1))
```
